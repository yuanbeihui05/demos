import numpy as np
import pyvista as pv

xyz_poly_coefs = (
                  np.array([
                    [[3.33333, -11.2091, 1.61803, 0, 0], [-21.3907, 24.128, -11.1776, 1.2, 0], [16.1803, -54.2202, 1.25, 0, 0], [0, 16, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.428571, -83.3931, 2.37312, 0, 0], [-71.5388, 67.5227, -57.9064, 1.6, 0], [4.36869, -55.6134, .25, 0, 0], [0, .4, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[7, -23.3473, 2.21902, 0, 0], [-46.2444, 35.9591, -20.3596, 1.14286, 0], [7.44296, -48.1806, 1.33333, 0, 0], [0, 9, 0, 0, 0], [0, 0, 0, 0, 0]],
                    ]).transpose(1,2,0),

                  np.array([
                    [[3.33333, 14.4631, 1.54098, 0, 0], [-11.2091, -8.27283, 1.12916, 1.33333, 0], [1.61803, .25, 1.16667, 0, 0], [0, .8, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.428571, 19.999, 3.10123, 0, 0], [-83.3931, 38.4902, 4.4077, .5, 0], [2.37312, .5, .625, 0, 0], [0, 1.33333, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[7, 31.815, 3.42869, 0, 0], [-23.3473, -4.35741, 10.6865, 2.57143, 0], [2.21902, .444444, .333333, 0, 0], [0, 1.6, 0, 0, 0], [0, 0, 0, 0, 0]],
                    ]).transpose(1,2,0),

                  np.array([
                    [[3.33333, 20.1478, 2.73268, 0, 0], [14.4631, -7.69977, 3.69646, 1.6, 0], [1.54098, 4, 1.33333, 0, 0], [0, .571429, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.428571, 95.7532, 2.35771, 0, 0], [19.999, -59.377, 50.3502, 1.2, 0], [3.10123, .285714, 1.8, 0, 0], [0, 3.33333, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[7, 43.01, 3.23607, 0, 0], [31.815, -30.73, 18.415, .5, 0], [3.42869, .5, .75, 0, 0], [0, 1.66667, 0, 0, 0], [0, 0, 0, 0, 0]],
                    ]).transpose(1,2,0),

                  np.array([
                    [[3.33333, -2.01107, 4.8541, 0, 0], [20.1478, -13.8265, -17.2429, 2.66667, 0], [2.73268, 2, 1, 0, 0], [0, 1.77778, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.428571, 39.1797, 15.1017, 0, 0], [95.7532, -56.0662, -14.1189, 18, 0], [2.35771, 3, .857143, 0, 0], [0, 1.71429, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[7, -5.23329, 4.44959, 0, 0], [43.01, -18.4334, -23.2344, 5, 0], [3.23607, .166667, 1, 0, 0], [0, 3.5, 0, 0, 0], [0, 0, 0, 0, 0]],
                    ]).transpose(1,2,0),

                  np.array([
                    [[3.33333, -21.3907, 16.1803, 0, 0], [-2.01107, 22.3123, 1, 4, 0], [4.8541, 4, .8, 0, 0], [0, 3.33333, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.428571, -71.5388, 4.36869, 0, 0], [39.1797, 26.3041, .6, 5, 0], [15.1017, 1, .1, 0, 0], [0, .666667, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[7, -46.2444, 7.44296, 0, 0], [-5.23329, 30.4021, 1.2, .2, 0], [4.44959, 9, 10, 0, 0], [0, .5, 0, 0, 0], [0, 0, 0, 0, 0]],
                    ]).transpose(1,2,0),

                  )
uv_ranges = [[[0, 1],[0, 1]]]*5

if __name__ == '__main__':
    pv.set_plot_theme('paraview')
    plotter = pv.Plotter()
    plotter.set_color_cycler([
        "#e60049", "#0bb4ff", "#50e991", "#e6d800", "#9b19f5", 
        "#ffa300", "#dc0ab4", "#b3d4ff", "#00bfa0"
        ])
    plotter.show_axes_all()
    plotter.show_grid()
    plotter.enable_anti_aliasing()

    for (u_range,v_range),coefs in zip(uv_ranges, xyz_poly_coefs): 
        u = np.linspace(u_range[0], u_range[1], 20)
        v = np.linspace(v_range[0], v_range[1], 20)
        value = np.polynomial.polynomial.polygrid2d(u, v, coefs)

        mesh = pv.StructuredGrid(value[0], value[1], value[2])   
        plotter.add_mesh(mesh, smooth_shading=True, split_sharp_edges=True)

    plotter.show()
