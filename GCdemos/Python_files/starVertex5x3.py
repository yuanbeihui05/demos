import numpy as np
import pyvista as pv

xyz_poly_coefs = (
                  np.array([
                    [[.111111, -15.1236, 9.79989, 0, 0], [-15.0015, 21.158, -49.2971, 28.3798, 0], [-5.16173, -12.7625, .8, 0, 0], [0, -18.9259, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.1, -10.4545, 9.43505, 0, 0], [.619802, 8.92846, -41.7404, 29.2825, 0], [-6.92874, 15.1317, .111111, 0, 0], [0, -22.9933, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.4, -20.4698, 23.4055, 0, 0], [-8.31433, 23.9335, -91.2682, 72.7419, 0], [-17.4378, 23.6557, 3.5, 0, 0], [0, -60.4299, 0, 0, 0], [0, 0, 0, 0, 0]],
                    ]).transpose(1,2,0),

                  np.array([
                    [[.111111, 5.65464, -7.2161, 0, 0], [-15.1236, 9.64914, 21.8457, -28.3518, 0], [9.79989, .6, .25, 0, 0], [0, 3.33333, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.1, -7.08101, -5.27704, 0, 0], [-10.4545, 15.6563, .388233, -19.0768, 0], [9.43505, 1.5, .333333, 0, 0], [0, 1.25, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.4, -4.3367, -15.1461, 0, 0], [-20.4698, 30.2994, 28.0264, -55.0139, 0], [23.4055, .285714, .5, 0, 0], [0, 3, 0, 0, 0], [0, 0, 0, 0, 0]],
                    ]).transpose(1,2,0),

                  np.array([
                    [[.111111, 18.6183, .679837, 0, 0], [5.65464, -25.5582, .444444, .2, 0], [-7.2161, 5.14286, 1, 0, 0], [0, 5, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.1, 6.07815, .927051, 0, 0], [-7.08101, -13.4265, 6.4, 1, 0], [-5.27704, 1.2, 3, 0, 0], [0, 2, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.4, 17.7896, 2.42063, 0, 0], [-4.3367, -43.6606, 4.8, 3.33333, 0], [-15.1461, 2.4, 1.5, 0, 0], [0, 6, 0, 0, 0], [0, 0, 0, 0, 0]],
                    ]).transpose(1,2,0),

                  np.array([
                    [[.111111, 5.85212, 1.31332, 0, 0], [18.6183, 3.38504, 3.55556, .25, 0], [.679837, 28, 2.5, 0, 0], [0, 2, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.1, 10.8375, 1.77685, 0, 0], [6.07815, 7.05937, 12, 1.75, 0], [.927051, 1.14286, .4, 0, 0], [0, 2, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.4, 15.3313, 6.79837, 0, 0], [17.7896, 24.6635, 2, 10, 0], [2.42063, 18, 9, 0, 0], [0, 4.5, 0, 0, 0], [0, 0, 0, 0, 0]],
                    ]).transpose(1,2,0),

                  np.array([
                    [[.111111, -15.0015, -5.16173, 0, 0], [5.85212, -8.99531, 1.25, 2.22222, 0], [1.31332, 2.66667, .5, 0, 0], [0, 4, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.1, .619802, -6.92874, 0, 0], [10.8375, -18.259, 3, .571429, 0], [1.77685, 1.14286, 2, 0, 0], [0, 4, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.4, -8.31433, -17.4378, 0, 0], [15.3313, -35.2107, 6, 4, 0], [6.79837, 6, 1.4, 0, 0], [0, 12, 0, 0, 0], [0, 0, 0, 0, 0]],
                    ]).transpose(1,2,0),

                  )
uv_ranges = [[[0, 1],[0, 1]]]*5

if __name__ == '__main__':
    pv.set_plot_theme('paraview')
    plotter = pv.Plotter()
    plotter.set_color_cycler([
        "#e60049", "#0bb4ff", "#50e991", "#e6d800", "#9b19f5", 
        "#ffa300", "#dc0ab4", "#b3d4ff", "#00bfa0"
        ])
    plotter.show_axes_all()
    plotter.show_grid()
    plotter.enable_anti_aliasing()

    for (u_range,v_range),coefs in zip(uv_ranges, xyz_poly_coefs): 
        u = np.linspace(u_range[0], u_range[1], 20)
        v = np.linspace(v_range[0], v_range[1], 20)
        value = np.polynomial.polynomial.polygrid2d(u, v, coefs)

        mesh = pv.StructuredGrid(value[0], value[1], value[2])   
        plotter.add_mesh(mesh, smooth_shading=True, split_sharp_edges=True)

    plotter.show()
