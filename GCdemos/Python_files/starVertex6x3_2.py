import numpy as np
import pyvista as pv

xyz_poly_coefs = (
                  np.array([
                    [[1.6, -23.25, 2, 0, 0], [-20.3254, 38.1214, -56.2143, 4, 0], [-1.16468, -37.9921, 2, 0, 0], [0, -28.6587, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.555556, -6.28016, 3.66667, 0, 0], [5.31508, -5.78254, -34.227, 4, 0], [4.42381, -10.0651, 5, 0, 0], [0, 16.3619, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[1.14286, -8.41667, .6, 0, 0], [.516667, -5.44444, -20.6333, 1.6, 0], [-.205556, .998413, 1, 0, 0], [0, -1.48889, 0, 0, 0], [0, 0, 0, 0, 0]],
                    ]).transpose(1,2,0),

                  np.array([
                    [[1.6, -2.9246, 2.42857, 0, 0], [-23.25, 12.3786, -16.0079, 5.71429, 0], [2, 1.71429, 3.5, 0, 0], [0, 4, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.555556, -11.5952, 2.2, 0, 0], [-6.28016, 25.6762, -35.9905, 1.6, 0], [3.66667, 7, .571429, 0, 0], [0, 10.6667, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[1.14286, -8.93333, 1.05, 0, 0], [-8.41667, 23.4778, -32.0667, 1.2, 0], [.6, 1.4, .6, 0, 0], [0, .8, 0, 0, 0], [0, 0, 0, 0, 0]],
                    ]).transpose(1,2,0),

                  np.array([
                    [[1.6, 20.3254, 6.75, 0, 0], [-2.9246, -1.67222, 11.6508, 7, 0], [2.42857, .444444, 2, 0, 0], [0, 4, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.555556, -5.31508, .75, 0, 0], [-11.5952, 1.91429, -17.2302, 2, 0], [2.2, 4, .8, 0, 0], [0, 7.2, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[1.14286, -.516667, 1.27778, 0, 0], [-8.93333, -3.51111, -8.71587, 4.66667, 0], [1.05, 10, .75, 0, 0], [0, 3, 0, 0, 0], [0, 0, 0, 0, 0]],
                    ]).transpose(1,2,0),

                  np.array([
                    [[1.6, 23.25, 8.75, 0, 0], [20.3254, -25.4786, 3.5, 3, 0], [6.75, 2, .4, 0, 0], [0, 20, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.555556, 6.28016, 2.54286, 0, 0], [-5.31508, 10.2159, 1.5, 4.57143, 0], [.75, 3.6, .25, 0, 0], [0, 1, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[1.14286, 8.41667, 3.5, 0, 0], [-.516667, 7.1, .5, 4, 0], [1.27778, 2.57143, .75, 0, 0], [0, .444444, 0, 0, 0], [0, 0, 0, 0, 0]],
                    ]).transpose(1,2,0),

                  np.array([
                    [[1.6, 2.9246, 1.26389, 0, 0], [23.25, -3.52143, .222222, 1.5, 0], [8.75, 8, .142857, 0, 0], [0, 32, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.555556, 11.5952, 4.75, 0, 0], [6.28016, -17.6905, 1.33333, 18, 0], [2.54286, .888889, .777778, 0, 0], [0, 5.6, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[1.14286, 8.93333, 2.46667, 0, 0], [8.41667, -16.9333, 1, 6.66667, 0], [3.5, 2.33333, 3.5, 0, 0], [0, 10, 0, 0, 0], [0, 0, 0, 0, 0]],
                    ]).transpose(1,2,0),

                  np.array([
                    [[1.6, -20.3254, -1.16468, 0, 0], [2.9246, .2, 2, 24, 0], [1.26389, .571429, 4.5, 0, 0], [0, 3.55556, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[.555556, 5.31508, 4.42381, 0, 0], [11.5952, 4, 3, 1.33333, 0], [4.75, 2.85714, .5, 0, 0], [0, 1, 0, 0, 0], [0, 0, 0, 0, 0]],
                    [[1.14286, .516667, -.205556, 0, 0], [8.93333, 4, .857143, .666667, 0], [2.46667, 7, 1, 0, 0], [0, 3.2, 0, 0, 0], [0, 0, 0, 0, 0]],
                    ]).transpose(1,2,0),

                  )
uv_ranges = [[[0, 1],[0, 1]]]*6

if __name__ == '__main__':
    pv.set_plot_theme('paraview')
    plotter = pv.Plotter()
    plotter.set_color_cycler([
        "#e60049", "#0bb4ff", "#50e991", "#e6d800", "#9b19f5", 
        "#ffa300", "#dc0ab4", "#b3d4ff", "#00bfa0"
        ])
    plotter.show_axes_all()
    plotter.show_grid()
    plotter.enable_anti_aliasing()

    for (u_range,v_range),coefs in zip(uv_ranges, xyz_poly_coefs): 
        u = np.linspace(u_range[0], u_range[1], 20)
        v = np.linspace(v_range[0], v_range[1], 20)
        value = np.polynomial.polynomial.polygrid2d(u, v, coefs)

        mesh = pv.StructuredGrid(value[0], value[1], value[2])   
        plotter.add_mesh(mesh, smooth_shading=True, split_sharp_edges=True)

    plotter.show()
